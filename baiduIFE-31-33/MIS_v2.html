<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>MIS</title>
    <link rel="stylesheet" href="css/style.css">
</head>

<body>
    <form>
        <ul id="region">
            <h2>地区</h2>
            <li>
                <label for="华东">华东</label>
                <input type="checkbox" id="华东" value="华东">
            </li>
            <li>
                <label for="华东">华南</label>
                <input type="checkbox" id="华南" value="华南">
            </li>
            <li>
                <label for="华东">华北</label>
                <input type="checkbox" id="华北" value="华北">
            </li>
            <li>
                <label for="全选">全选</label>
                <input type="checkbox" id="地区全选" value="地区全选">
            </li>
        </ul>

        <ul id="product">
            <h2>商品</h2>
            <li>
                <label for="手机">手机</label>
                <input type="checkbox" id="手机" value="手机">
            </li>
            <li>
                <label for="笔记本">笔记本</label>
                <input type="checkbox" id="笔记本" value="笔记本">
            </li>
            <li>
                <label for="智能音箱">智能音箱</label>
                <input type="checkbox" id="智能音箱" value="智能音箱">
            </li>
            <li>
                <label for="全选">全选</label>
                <input type="checkbox" id="商品全选" value="商品全选">
            </li>
        </ul>

    </form>
    <div id="table-wrapper"></div>

    <script type="text/javascript" src="JavaScript/ife31data.js"></script>
    <script>
        var regionSelect = document.getElementById("region");
        var productSelect = document.getElementById("product");
        var form = document.getElementsByTagName("form")[0];
        var tableWrapper = document.getElementById("table-wrapper");
        var tableHead = ["商品", "地区", "1月", "2月", "3月", "4月", "5月", "6月", "7月", "8月", "9月", "10月", "11月", "12月"];

        var huadong = document.getElementById("华东");
        renderTable(getDataBySelect()); //默认值渲染一次
        form.onchange = function () {
            renderTable(getDataBySelect());
        }

        function getDataBySelect() {  //获取数据
            var myData = [];
            for (let i = 0; i < sourceData.length; i++) {
                if (regionSelect.value == sourceData[i].region && product.value == sourceData[i].product) { //同时满足两个表单选项
                    myData.push(sourceData[i]);
                }
            }

            return myData; //返回一个对象数组
        }
        function renderTable(data) { //渲染新的表格
            tableWrapper.innerHTML = "";  //清除上次的数据
            var table = document.createElement("table");
            tableWrapper.appendChild(table);
            var tr = document.createElement("tr");
            table.appendChild(tr);
            for (let i = 0; i < tableHead.length; i++) {  //添加表头
                var th = document.createElement("th");
                th.innerHTML = tableHead[i];
                tr.appendChild(th);
            }


            for (let i = 0; i < data.length; i++) {
                var tr = document.createElement("tr");
                table.appendChild(tr);
                for (x in data[i]) {  //遍历对象的属性x
                    if (x == "product" || x == "region") {
                        var td = document.createElement("td");
                        td.innerHTML = data[i][x] || data[i][x];
                        tr.appendChild(td);
                    } else {
                        for (let j = 0; j < data[i][x].length; j++) { //data[i]对象的的第三个属性是数组，对齐进行遍历填充
                            var td = document.createElement("td");
                            td.innerHTML = data[i][x][j];
                            tr.appendChild(td);
                        }
                    }
                }
            }
        }
    </script>
</body>


</html>